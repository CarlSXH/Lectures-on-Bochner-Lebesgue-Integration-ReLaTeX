
\section{The Definitions of Measurable Functions}

Let $(X,S,\mu)$ be a measure space, and let $B$ be a Banach space (we are not assuming that the range of $\mu$ is in $B$). In this section we will define certain classes of functions from $X$ to $B$ which are nicely related to $S$ and $\mu$. Eventually these classes will provide us with functions which we can try to integrate with respect to $\mu$.

The simplest functions from $X$ to $B$ which are nicely related to $S$ are the functions which are constant on a measurable set $E$ and have value 0 elsewhere. These functions can be written as $b\idf{E}$ where $b$ is the value of the function on $E$ and $\idf{E}$ is the characteristic function of $E$, that is, the real valued function which has value $1$ on $E$ and 0 elsewhere. Since the functions of the form $b\idf{E}$ take values in a Banach space, we can add these functions (pointwise). It is not difficult to convince oneself that the functions obtained by taking finite sums of functions of the type described above are exactly those described in the following definition.

\begin{definition}
A function, $f$, from $X$ to $B$ is called a \defline{simple $S$-measurable function} (or, for brevity, an \defline{$S$-simple function}) if the range of $f$ is a finite set, $\brc{b_1,\dots,b_n}$, in $B$, and if $f^{-1}(b_i)\in S$ for each $b_i\neq0$.
\end{definition}

It is clear from the definition that the family of $B$-valued simple $S$-measurable functions is also precisely the collection of all functions $f$ from $X$ to $B$ of the form $f=\sum_{i=1}^nb_i\idf{E_i}$ where $b_i$'s are distinct non-zero elements of $B$ and the $E_i$'s are disjoint elements of $S$.

We will let the reader convince themselves that the $B$-valued simple $S$-measurable functions form a vector space under pointwise addition and scalar multiplication by the scalars which act on $B$.

In a Banach space, we have, in addition to vector space structure, a metric space structure, and so we can take pointwise limits of functions which have values in a Banach space.

\begin{definition}
A function, $f$, from $X$ to $B$ is said to be \defline{$S$-measurable} if there is a sequence, $f_n$, of simple $S$-measurable functions which converges to $f$ pointwise, that is, such that for every $x\in X$ the sequence $f_n(x)$ converges to $f(x)$.
\end{definition}

The definition of $S$-measurable functions does not depend on $\mu$. By using $\mu$ we can define a larger class of measurable functions. But we first state a general definition whose use pervades measure theory.

\begin{definition}\label{def:a.e.}
Let $(X,S,\mu)$ be a measure space, and let $P$ be a property which may or may not hold for various points of $X$. Then $P$ is said to hold, or be true, \defline{almost everywhere} on $X$ (abbreviated a.e.) if there is a null set $N$ for $\mu$ such that the property $P$ is true for all points in $X$ except possibly those in $N$.
\end{definition}

This definition will be illustrated in Definition \ref{def:mu measurable function}.

\begin{definition}
A function, $f$, from $X$ to $B$ is called a \defline{simple $\mu$-measurable function} if $f$ is a simple $(S\du\nring\mu)$-measurable function. (The definition of $S\du\nring\mu$ was given in Theorem \ref{thm:completion of general measure}.)
\end{definition}

\begin{definition}\label{def:mu measurable function}
A function, $f$, with values in $B$, which is defined almost everywhere on $X$, is said to be \defline{$\mu$-measurable} if there is a sequence, $f_n$, of simple $\mu$-measurable functions which converges pointwise to $f$ almost everywhere.
\end{definition}

Thus in Definition \ref{def:a.e.}, we allow $f$ to be undefined on a null set of $\mu$, and we allow there to be a (possibly larger) null set on which the sequence $f_n$ does not necessarily converge to $f$ pointwise.

We note that since any simple $S$-measurable function is clearly a simple $\mu$-measurable function, it follows that any $S$-measurable function is $\mu$-measurable.

The following proposition serves to clarify further the relation between $S$-measurable and $\mu$-measurable functions.

\begin{proposition}
A function, $f$, defined almost everywhere on $X$, is $\mu$-measurable if and only if there exists a sequence of simple $S$-measurable functions which converges pointwise to $f$ almost everywhere.
\end{proposition}

\begin{proof}
If $f$ is $\mu$-measurable, then there exist a sequence, $f_n$, of simple $\mu$-measurable functions and a null set $N_0$, such that $f_n$ converges to $f$ off $N_0$. Since the functions $f_n$ are simple $\mu$-measurable functions it follows that for each $n$ we have $f_n=\sum_{i=1}^{k_n}b_i^n\idf{F_i^n}$ where each $b_i^n\in B$ and each $F_i^n\in S\du\nring{\mu}$. Now $F_i^n=E_i^n\du N_i^n$ where $E_i^n\in S$ and $N_i^n\in\nring{\mu}$. If we let $N=N_0\cup\bigcup_{i, n} N_i^n$, then $N$ is a null set. Furthermore, if we let $g_n=\sum_{i=1}^{k_n}b_i^n\idf{E_i^n}$, then each $g_n$ is a simple $S$-measurable function. Finally, since $g_n=f_n$ off $N$, it follows that the $g_n$ converge to $f$ a.e. The converse is clear.
\end{proof}

We noted above that any $S$-measurable function is $\mu$-measurable. It follows that $S$-measurable functions are simultaneously $\mu$-measurable for all measures $\mu$ on $S$, and for this reason it is generally in contexts in which one is working with many measures on $S$ that the class of $S$-measurable functions is useful. On the other hand, it is usually in contexts in which one is working with only one measure on $S$ that it is convenient to use the larger class of all $\mu$-measurable functions.

We remark that when one is working with real valued $\mu$-measurable functions, it is occasionally convenient to permit these functions to take the value $+\infty$ (for example, when using Fubini's theorem). Usually this value will be taken only at the points of some null set, and so we can treat such a function by considering it to be undefined at such points. However, if one prefers, much of measure theory can be developed so as to include functions which take value $+\infty$. Almost all of the results of the rest of this chapter hold for such functions (some statements may have to be modified slightly), but most proofs must include special arguments for the set on which the value $+\infty$ is taken. We will not allow such functions in our development of the theory, but in several places we will indicate where it might be convenient to use such functions.

The next proposition collects together some elementary facts about measurable functions

\begin{proposition}\label{prop:sum product of meas function}
Let $f$ and $g$ be $S$-measurable ($\mu$-measurable) functions from $X$ to $B$, and let $r$ be a scalar. Then $f+g, rf$, and $\norm{f(\imarg)}$ are $S$-measurable ($\mu$-measurable) functions. If, instead, $f$ is scalar-valued, then $fg$ is $S$-measurable ($\mu$-measurable). If $f$ and $g$ are real-valued, then $\max(f, g)$ and $\min(f, g)$ are $S$-measurable ($\mu$-measurable).
\end{proposition}

\begin{proof}
The first four facts follow almost immediately from the definitions of measurable functions. For example, if $f_n$ and $g_n$ are sequences of simple measurable functions which converge to $f$ and $g$ respectively, then it is clear that $f_n+g_n$ is a sequence of simple measurable functions which converges to $f+g$. The final two facts follow from the previous ones and the facts that $\max(f, g)=(f+g+|f-g|)/2$ and $\min(f, g)=(f+g-|f-g|)/2$.
\end{proof}

\section{Characterizations of Measurable Functions}

Unlike the facts stated in the last proposition, it is not at all clear that the pointwise limit of measurable functions is again measurable. In this section we will obtain a quite different characterization of measurable functions which, in addition to making this fact clear, is a very useful way of verifying that functions are measurable in many situations.

\begin{lemma}\label{lem:preimage of open set as sigma union intersection}
If $f_n$ is a sequence of functions from $X$ to $B$ which converges pointwise to a function $f$, and if for any open subset, $U$, of $B$ we define $U_n$ to be $\brc{y\in U:d(y,\comp{U})>\frac1n}$ (where $\comp{U}$ is the complement of $U$ in $B$, and $d(y,\comp{U})=\inf\brc{\norm{y-z}:z\in\comp{U}}$), then $f^{-1}(U)=\bigcup_{n=1}^\infty\bigcup_{K=1}^\infty\bigcap_{k=K}^\infty f_k^{-1}(U_n)$ for every open subset, $U$, of $B$.
\end{lemma}

\begin{proof}
The proof is given by the following chain of equivalent statements (where ``iff'' stands for ``if and only if''): $x\in f^{-1}(U)$ iff $f(x)\in U$, iff there exist integers $n$ and $K$ such that $f_k(x)\in U_n$ for all $k\geq K$, iff there exist $n$ and $K$ such that $x\in f_k^{-1}(U_n)$ for all $k\geq K$, iff there exist $n$ and $K$ such that $x\in\bigcap_{k=K}^\infty f_k^{-1}(U_n)$, iff $x\in\bigcup_{n=1}^\infty\bigcup_{K=1}^\infty\bigcap_{k=K}^\infty f_k^{-1}(U_n)$.
\end{proof}

\begin{definition}
If $f$ is a function from $X$ to $B$, then we define the \defline{carrier} of $f$ to be $\brc{x\in X: f(x)\neq 0}$. We will denote the carrier of $f$ by $\car{f}$. 
\end{definition}

Recall that a subset of a metric space is said to be separable if it contains a countable dense subset. The following theorem was shown to us by S. Newberger.

\begin{theorem}\label{thm:characterization of meas func}
Let $f$ be a function from $X$ to $B$. Then $f$ is $S$-measurable if and only if
\begin{enumerate}[label=\arabic*),ref=\arabic*)]
    \item\label{thm:item:sep range} $f(X)$ (the range of $f$) is a separable subset of $B$, and
    \item\label{thm:item:car} $f^{-1}(U)\cap\car{f}\in S$ for every open ball, $U$, in $B$.
\end{enumerate}
\end{theorem}

\begin{proof}
Suppose that $f$ is an $S$-measurable function. Then there exists a sequence, $f_n$, of simple $S$-measurable functions which converges to $f$ pointwise. For each $n$ let $\brc{b_1^n,\dots,b_{k_n}^n}$ be the range of $f_n$, and let $K$ be the closure of the set of all the $b_i^n$ for all $n$ and all $i$. Clearly $K$ is separable and $f(X)\subseteq K$, and so $f(X)$ is separable. Now let $U$ be an open ball, or, in fact, any open subset of $B$. We need to show that $f^{-1}(U)\cap\car{f}\in S$. But $f^{-1}(U)\cap\car{f}=f^{-1}(U\sd\brc{0})$. Thus we need merely to show that if $U$ is any open set not containing 0, then $f^{-1}(U)\in S$. Now this is obviously true for simple $S$-measurable functions. It follows then from Lemma \ref{lem:preimage of open set as sigma union intersection} that it is true for $f$, since each $U_n$ of that lemma will also be an open set not containing 0.

Conversely, suppose that $f$ satisfies properties \ref{thm:item:sep range} and \ref{thm:item:car}. Then we can choose a sequence, $b_i$, of elements of $B$ which is dense in $f(X)$. We wish to define a sequence, $f_n$, of simple $S$-measurable functions which converges pointwise to $f$. We will define the $f_n$ so that in fact $f_n$ will have its values in $\brc{0,b_1,\dots,b_n}$ for each $n$. In order to do this, let $$C_{ij}=\brc{x\in X:x\in\car{f}\text{ and }\norm{f(x)-b_i}<1/j}$$ for all positive integers $i$ and $j$. Note that by property \ref{thm:item:car} each $C_{ij}$ is in $S$. We might at first glance want to define $f_n$ to have value $b_i$ on $C_{ij}$, but for this to make sense we must first disjointize the $C_{ij}$. However, in doing this we must be careful to keep as much of the $C_{ij}$ for which $j$ is large, since these are the sets on which $f$ is most closely approximated. To accomplish this we let $E_{i j}^n=C_{ij}\sd\bigcup_{(i,j)<(k,l)\leq(n,n)}C_{kl}$ for $1\leq i,j\leq n$, where the pairs $(i,j)$ are totally ordered ``antilexicographically'', that is, we say that $(i,j)\leq(k,l)$ if $j<l$, or if $j=l$ and $i\leq k$. Then for each fixed $n$ the sets $E_{i j}^n$ are disjoint and $E_{ij}^n\subseteq C_{ij}$ for all $i$ and $j$. Let $f_n=\sum_{i,j=1}^nb_i\idf{E_{ij}^n}$. We show that the sequence $f_n$ converges to $f$ pointwise. Thus suppose we are given $x\in X$ and $\ep>0$. We will assume that $x\in\car{f}$, since if $f(x)=0$ then $f_n(x)=0$ for all $n$, and so we are done. Choose $m_0$ such that $1/m_0<\ep$, and choose $i_0$ so that $\norm{f(x)-b_{i_0}}<1/m_0$. If we let $N=\max\brc{i_0, m_0}$, then we claim that $\norm{f(x)-f_n(x)}<\ep$ whenever $n>N$. To see this we note that $x\in C_{i_0m_0}$ by the definition of $i_0$ and $m_0$, and so if $n>N$, then $x\in E^n_{kl}$, where $(k,l)=\max\brc{(i,j):x\in C_{ij},(i_0,m_0)\leq(i,j)\leq(n, n)}$. It follows that $f_n(x)=b_k$ and that $\norm{f(x)-b_k}<1/l\leq 1/m_0<\ep$. Thus $\norm{f(x)-f_n(x)}<\ep$.
\end{proof}

\begin{corollary}\label{cor:characterization of meas func}
Let $f$ be a $B$-valued function defined almost everywhere on $X$. Then $f$ is $\mu$-measurable if and only if
\begin{enumerate}[label=\arabic*),ref=\arabic*)]
    \item\label{cor:item:sep range}
    there exists a null set $N$ such that $f(X\sd N)$ is separable, and
    \item\label{cor:item:car}
    $f^{-1}(U)\cap\car{f}\in S\du\nring{\mu}$ for all open balls, $U$, in $B$.
\end{enumerate}
\end{corollary}
\begin{proof}
Suppose that $f$ is $\mu$-measurable. Then by definition there exist a sequence, $f_n$, of simple $S\du\nring{\mu}$-measurable functions and a null set $N$ such that $f_n$ converges to $f$ pointwise off $N$. Thus $f_n\idf{X\sd N}$ is a sequence of simple $(S\du\nring{\mu})$-measurable functions which converges pointwise to $f\idf{X\sd N}$ (which we take to have value 0 where $f$ is undefined), and so $f\idf{X\sd N}$ is an $(S\du\nring{\mu})$-measurable function. The fact that $f$ satisfies properties \ref{cor:item:sep range} and \ref{cor:item:car} now follow easily from Theorem \ref{thm:characterization of meas func}.

Conversely, suppose that $f$ satisfies properties \ref{cor:item:sep range} and \ref{cor:item:car}, and let $N$ be a null set such that $f(X\sd N)$ is separable. Then clearly, $f\idf{X\sd N}$ satisfies \ref{thm:item:car} and has separable range, so that $f\idf{X\sd N}$ is $(S\du\nring{\mu})$-measurable by Theorem \ref{thm:characterization of meas func}. It follows easily that $f$ is $\mu$-measurable.
\end{proof}

\begin{lemma}
Let $f$ be a function from $X$ to $B$. Then the following are equivalent:
\begin{enumerate}[label=\arabic*),ref=\arabic*)]
    \item\label{lem:item:car cond1}
    $f^{-1}(C)\cap\car{f}$ is in $S$ for every closed set, $C$, in $B$
    \item\label{lem:item:car cond2}
    $f^{-1}(U)\cap\car{f}$ is in $S$ for every open set, $U$, in $B$
    \item\label{lem:item:car cond3}
    $f^{-1}(W)\cap\car{f}$ is in $S$ for every Borel set, $W$, in $B$
\end{enumerate}
\end{lemma}
\begin{proof}
\ref{lem:item:car cond1} implies \ref{lem:item:car cond2}: Let $U$ be an open subset of $B$ and let $C_n=\brc{y\in B:d(x,\comp{U})\geq\frac1n}$, where $d(y,\comp{U})$ is defined as in Lemma \ref{lem:preimage of open set as sigma union intersection}. Then $C_n$ is closed for each $n$, $U=\bigcup_{n=1}^\infty C_n$, ad $f^{-1}(U)=\bigcup_{n=1}^\infty f^{-1}(C_n)$, from which the implication follows immediately.

\ref{lem:item:car cond2} implies \ref{lem:item:car cond3}: $f^{-1}$ is a Boolean algebra homomorphism, that is, $f^{-1}\br{\bigcup_{\alpha\in A}Y_\alpha}=\bigcup_{\alpha\in A}f^{-1}(Y_\alpha)$, $f^{-1}\br{\bigcap_{\alpha\in A}Y_\alpha}=\bigcap_{\alpha\in A}f^{-1}(Y_\alpha)$ and $f^{-1}(B\sd Y)=X\sd f^{-1}(Y)$, where $Y,Y_\alpha\subseteq B$ for all $\alpha\in A$, where $A$ is an arbitrary indexing set. Thus the family of sets $Y$ having the property that $f^{-1}(Y)\cap\car{f}\in S$, is a $\sigma$-field which by assumption contains the open sets of $B$, and so contains the $\sigma$-field of Borel sets of $B$.

\ref{lem:item:car cond3} implies \ref{lem:item:car cond1}: Closed sets are Borel sets.
\end{proof}

\begin{corollary}
In the statements of Theorem \ref{thm:characterization of meas func} and Corollary \ref{cor:characterization of meas func} we can substitute the words ``open subset'', ``closed subset'' or ``Borel subset'' for the words ``open ball''.
\end{corollary}

\begin{proof}
In the first part of the proof of Theorem \ref{thm:characterization of meas func} it was seen that if $f$ is $S$-measurable, then condition \ref{thm:item:car} holds for any open set $U \subset B$. The rest is easily verified.
\end{proof}

We are now in a position to prove the result about the limit of a sequence of measurable functions which was mentioned at the beginning of this section.

\begin{proposition}
If a sequence, $f_n$, of $S$-measurable ($\mu$-measurable) functions converges pointwise (a.e.) to a function $f$, then $f$ is $S$-measurable ($\mu$-measurable).
\end{proposition}

\begin{proof}
We give the proof for the case of $S$-measurable functions only, since the proof for $\mu$-measurable functions is very similar.

Since $f_n$ is $S$-measurable, $f_n(X)$ is separable. Thus the closure of $\bigcup_{n=1}^\infty f_n(x)$ is separable. But it is clear that $f(X)$ is contained in this closure, and so $f(X)$ is separable. Thus $f$ satisfies hypothesis \ref{thm:item:sep range} of Theorem \ref{thm:characterization of meas func}; That $f$ satisfies hypothesis \ref{thm:item:car} follows immediately from Lemma \ref{lem:preimage of open set as sigma union intersection}.
\end{proof}

\section{Almost Uniform Convergence}

For many purposes pointwise convergence is an insufficiently strong type of convergence. The next theorem shows that if the functions considered are measurable, then pointwise convergence actually implies a stronger kind of convergence.

\begin{theorem}[Egoroff (1911)]\label{thm:egoroff}
Let $\mu$ be a non-negative measure on a $\sigma$-ring $S$. If $E\in S$ and $\mu(E)<\infty$, and if $f_n$ is a sequence of $\mu$-measurable functions which converges to a function $f$ a.e. on $E$, then for every $\ep>0$ there exists a measurable set $F\subseteq E$ such that $\mu(E\sd F)<\ep$ and the sequence $f_n$ converges to $f$ uniformly on $F$.
\end{theorem}

\begin{proof}
By removing a null set, we can assume that $f_n$ converges to $f$ everywhere on $E$. For any positive integers $m$ and $n$ let $$E_n^m=\brc{x\in E:\norm{f(x)-f_k(x)}\geq 1/m\text{ for some }k\geq n}.$$ Since each $f_n$, and so $f$, is $\mu$-measurable, it is easily seen by using Proposition \ref{prop:sum product of meas function} and the easy half of Corollary \ref{cor:characterization of meas func} that each $E_n^m$ is in $S \du\nring{\mu}$. Now for fixed $m$ we have $E_n^m\downarrow_n\varnothing$ because $f_n$ converges to $f$. Since $E$, and thus the $E_n^m$, have finite measure, it follows from Proposition \ref{prop:increase limit of measures} that for fixed $m$ the sequence $\mu(E_n^m)$ converges to $0$ as $n$ goes to $\infty$.

Let $\ep>0$ be given. For each $m$ choose $n(m)$ such that $\mu(E_{n(m)}^m)<\ep/2^m$, and let $F=E\sd\bigcup_{m=1}^\infty E_{n(m)}^m$. Then $\mu(E\sd F)\leq\sum_{m=1}^\infty\mu(E_{n(m)}^m)<\ep$. We show that $f_n$ converges to $f$ uniformly on $F$. Given $\delta>0$, choose $m$ so that $1/m<\delta$, and let $N=n(m)$. Now if $x\in F$, then $x\notin E_N^m$, and so for $k\geq N$ we have $\norm{f(x)-f_k(x)}<1/m<\delta$.

Finally, the $F$ just obtained is in $S\du\nring{\mu}$, but if it is desired we can remove a null set so that $F\in S$.
\end{proof}

As is the case with many important theorems, Egoroff's theorem leads naturally to a definition.

\begin{definition}
Let $\mu$ be a non-negative measure on a measure space $(X,S)$, and let the corresponding outer measure be $\mu^*$. A sequence $f_n$ of arbitrary functions on $X$ is said to converge \defline{almost uniformly} on $E\subseteq X$ to a function $f$ if for every $\ep>0$ there exists $F\subseteq E$ such that $E\sd F$ is in the domain of $\mu^*$, $\mu^*(E\sd F)<\ep$, and $f_n$ converges to $f$ uniformly on $F$. (We will abbreviate ``almost uniformly'' by ``a.u.''.)
\end{definition}

Using this definition, Egoroff's theorem states that if $f_n$ is any sequence of $\mu$-measurable functions which converges a.e. to a function, $f$, on a set $E$ of finite measure, then $f_n$ converges to $f$ a.u. on $E$. It is not difficult to find example which show that the condition that $E$ of finite measure is necessary.

The next result shows that even for arbitrary functions on arbitrary sets, convergence a.u. is stronger than convergence a.e.

\begin{proposition}\label{prop:au implies ae}
If $f_n$ is a sequence of arbitrary functions which converges to $f$ a.u. on arbitrary $E\subseteq X$, then $f_n$ converges to $f$ a.e.
\end{proposition}

\begin{proof}
For each $m$ choose $F_m\subseteq E$ such that $\mu^*(E\sd F_m)<1/m$ and $f_n$ converges to $f$ uniformly on $F_m$. Then $f_n$ converges pointwise to $f$ on $\bigcup_mF_m$, and $\mu^*\br{E\sd\bigcup_m F_m}=0$.
\end{proof}

\begin{definition}
A sequence, $f_n$, of arbitrary functions on $X$ is said to be \defline{almost uniformly Cauchy} on $E\subseteq X$ if for each $\ep>0$ there exist $F\subseteq E$ such that $E\sd F$ is in the domain of $\mu^*$, $\mu^*(E\sd F)<\ep$, and the $f_n$ are uniformly Cauchy on $F$ (that is, given $\delta>0$ there exists $N$ such that if $m,n\geq N$, then $\norm{f_m(x)-f_n(x)}<\delta$ for all $x\in F$).
\end{definition}

The next proposition, which is a preliminary completeness result, is probably the first place at which it is important that the functions which we are considering take values in a Banach (hence complete) space.

\begin{proposition}\label{prop:au cauchy implies limit}
If $f_n$ is an almost uniformly Cauchy sequence of functions on $E\subseteq X$, then there exists a function $f$ such that $f_n$ converges to $f$ a.u. on $E$. Furthermore, $f$ is unique a.e. on $E$ (that is, if $f$ and $f'$ are two such limit functions, then $f$ and $f'$ coincide except on a null set in $E$).
\end{proposition}

\begin{proof}
For each integer $m$ choose $F_m\subset E$ such that $\mu^*(E\sd F_m)<1/m$, and $f_n$ is uniformly Cauchy on $F_m$. Let $F=\bigcup_mF_m$, so that $\mu^*(E\sd F)=0$. If $x\in F$, then $x\in F_m$ for some $m$, and so $f_n(x)$ is a Cauchy sequence. Define $f$ by $f(x)=\lim f_n(x)$ for $x\in F$, and let $f$ be anything (e.g. 0) on $E\sd F$. We show that $f_n$ converges to $f$ a.u. on $E$. Given $\ep>0$, choose $m$ so $1/m<\ep$. Then $\mu^*(E\sd F_m)<1/m<\ep$ and $f_n$ is uniformly Cauchy on $F_m$ and converges pointwise, and so uniformly, to $f$ on $F_m$. The uniqueness a.e. of $f$ follows from Proposition \ref{prop:au implies ae}.
\end{proof}

\section{Convergence in Measure}

In this section we study another type of convergence for functions, which will be of considerable use later.
\begin{definition}
Let $\mu$ be a non-negative measure on $(X,S)$ with corresponding outer measure $\mu^*$. A sequence, $f_n$, of arbitrary functions on $X$ is said to converges to a function $f$ \defline{in measure} on $E\subseteq X$ if the intersections of $E$ with $\car{f}$ and the $\car{f_n}$ are in the domain of $\mu^*$, and if for every $\ep>0$, $$\lim_{n\to+\infty}\mu^*(\brc{x\in E:\norm{f(x)-f_n(x)}\geq\ep})=0.$$
\end{definition}

Our first result shows that limits in measure are unique a.e.

\begin{proposition}\label{prop:uniqueness of in measure}
If $f_n$ converges in measure on $E$ to both $f$ and $g$, then $f(x)=g(x)$ a.e. on $E$.
\end{proposition}

\begin{proof}
Using the triangle inequality, we see that for any $\ep>0$ and $n$ we have
\begin{align*}
&\brc{x\in E:\norm{f(x)-g(x)}\geq\ep}\\
&\quad\subseteq\brc{x\in E:\norm{f(x)-f_n(x)}\geq\ep/2}\cup\brc{x\in E:\norm{g(x)-f_n(x)}\geq\ep/2}.
\end{align*}
Applying $\mu^*$ to both sides and letting $n$ go to $\infty$, we find that for each $\ep>0$ $$\mu^*(\brc{x\in E:\norm{f(x)-g(x)}\geq\ep})=0.$$ Since $\brc{x\in E:\norm{f(x)-g(x)}\neq0}=\bigcup_{m=1}^\infty\brc{x\in E:\norm{f(x)-g(x)}\geq1/m}$, we are done.
\end{proof}

We leave the proof of the next proposition to the reader.

\begin{proposition}
If $f_n$ converges to $f$ in measure and $g_n$ converges to $g$ in measure, then
\begin{enumerate}[label=\arabic*)]
    \item $f_n+g_n$ converges to $f+g$ in measure,
    \item for any scalar $c$, $cf_n$ converges to $cf$ in measure,
    \item $\norm{f_n(\imarg)}$ converges to $\norm{f(\imarg)}$ in measure,
    \item for any $F\subseteq X$, $\idf{F}f_n$ converges to $\idf{X}f$ in measure.
\end{enumerate}
\end{proposition}

It is not difficult to find examples which show that convergence in measure does not imply converges a.e., much less converges a.u. (although Corollary \ref{cor:in measure implies subsequence ae} will show that there is a partial implication in this direction). Examples can also be found to show that convergence a.e. does not imply convergence in measure, at least on infinite sets. However we do have:

\begin{proposition}\label{prop:au implies in measure}
If $f_n$ converges a.u. to $f$ on $E$, and if the intersections of $E$ with $\car{f}$ and the $\car{f_n}$ are in the domain of $\mu^*$, then $f_n$ converges to $f$ in measure. 
\end{proposition}

\begin{proof}
Let $\delta>0$ be given, and choose $F\subseteq E$ so that $E\sd F$ is in the domain of $\mu^*$, $\mu^*(E\sd F)<\delta$, and $f_n$ converges to $f$ uniformly on $F$. Then for any $\ep>0$ choose $N$ so that $\norm{f(x)-f_n(x)}<\ep$ for all $n>N$ and for all $x\in F$. It follows that for any $n>N$ we have $$\mu^*(\brc{x\in E:\norm{f(x)-f_n(x)}\geq\ep})\leq\mu^*(E\sd F)<\delta.$$
\end{proof}

\begin{corollary}
If $f_n$ is a sequence of $\mu$-measurable functions which converges a.e. to $f$ on a set $E$ of finite measure, then $f_n$ converges to $f$ in measure on $E$.
\end{corollary}

\begin{proof}
This follows from Egoroff's theorem and Proposition \ref{prop:au implies in measure}.
\end{proof}

\begin{definition}
A sequence $f_n$ of functions is said to be \defline{Cauchy in measure} on $E\subseteq X$ if the intersection of $E$ with each $\car{f_n}$ is in the domain of $\mu^*$, and if for every $\ep>0$ $$\lim_{m,n\to+\infty}\mu^*(\brc{x\in X:\norm{f_m(x)-f_n(x)}\geq\ep})=0.$$
\end{definition}

We now come to the most important completeness result of this chapter. It is the crux cf the proof that certain function spaces (the $L^p$ spaces) defined in Chapter \ref{ch:Lp spaces} are complete, and so are Banach spaces.

\begin{theorem}[Riesz-Weyl]\label{thm:riesz weyl}
If a sequence, $f_n$, of functions is Cauchy in measure on $E\subseteq X$, then there exists a subsequence, $f_{n_k}$, which is almost uniformly Cauchy on $E$. Thus there exists a function $f$ such that $f_{n_k}$ converges to $f$ a.u. on $E$, and hence so that $f_n$ converges to $f$ in measure on $E$. Furthermore, $f$ is unique a.e. on $E$.
\end{theorem}

\begin{proof}
We define the sequence of integers, $n_k$, by induction. Let $n_1=1$. For $k>1$ choose $n_k$ so that $n_k>n_{k-1}$ and so that if $m,n\geq n_k$, then $$\mu^*(\brc{x\in E:\norm{f_m(x)-f_n(x)}\geq2^{-k}})\leq 2^{-k}.$$ For each $k$ we let $g_k=f_{n_k}$, and we show that this subsequence is almost uniformly Cauchy on $E$. Given $\ep>0$, choose $K$ so that $\sum_{k=K}^\infty 2^{-k}=2^{-(k-1)}<\ep$. Let $F=E\sd\bigcup_{k=K}^\infty\brc{x\in E:\norm{g_k(x)-g_{k+1}(x)}\geq2^{-k}}$. Then by the choice of the $n_k$ we have $\mu^*(E\sd F)<\ep$. We must show that $g_k$ is uniformly Cauchy on $F$. Given $\delta>0$ choose $N$ so that $N\geq K$ and $2^{-(N-1)}<\delta$. Then for any $j>l>N$ and $x\in F$ we have
\begin{align*}
&\norm{g_j(x)-g_l(x)}\\
&\quad=\norm{g_j(x)-g_{j-1}(x)+g_{j-1}(x)-g_{j-2}(x)+\dots+g_{l+1}(x)-g_l(x)}\\
&\quad\leq\norm{g_j(x)-g_{j-1}(x)}+\norm{g_{j-1}(x)-g_{j-2}(x)}+\dots+\norm{g_{l+1}(x)-g_l(x)}.
\end{align*}
From the definition of the $n_k$ and the fact that $j,l>k$ and that $x\in F$, it follows that $\norm{g_j(x)-g_l(x)}\leq\sum_{k=l}^{j-1}2^{-k}<2^{-(N-1)}<\delta$, so that the sequence $g_k$ is uniformly Cauchy on $F$.

From Proposition \ref{prop:au cauchy implies limit} it follows that $g_k$ converges a.u. to some function $f$. From Proposition \ref{prop:au implies in measure} it follows that $g_k$ converges to $f$ in measure on $E$. From the fact that $f_n$ is Cauchy in measure, and from the inclusion
\begin{align*}
&\brc{x\in E:\norm{f(x)-f_n(x)}\geq\ep}\\
&\quad\subseteq\brc{x\in E:\norm{f(x)-g_k(x)}\geq\ep/2}\cup\brc{x\in E:\norm{f_n(x)-g_k(x)}\geq\ep/2}
\end{align*}
it follows that, in fact, $f_n$ converges to $f$ in measure on $E$. The uniqueness of $f$ a.e. follows from Proposition \ref{prop:uniqueness of in measure}.
\end{proof}

We remark that, of course, if each of the $f_n$ is $\mu$-measurable, then $f$ will be $\mu$-measurable.

\begin{corollary}\label{cor:in measure implies subsequence ae}
If a sequence, $f_n$, of functions converges to a function $f$ in measure on $E\subseteq X$, then there exists a subsequence, $f_{n_k}$, which converges to $f$ almost uniformly on $E$.
\end{corollary}

\begin{proof}
From the fact that the sequence $f_n$ converges in measure to $f$ on $E$, it is easily seen that $f_n$ is Cauchy in measure on $E$. From Theorem \ref{thm:riesz weyl} it follows that there is a subsequence, $f_{n_k}$, and a function $g$ such that $f_{n_k}$ converges to $g$ a.u. Then $f_{n_k}$ converges in measure to both $f$ and $g$ by Proposition \ref{prop:au implies in measure}, and so $f=g$ a.e. by Proposition \ref{prop:uniqueness of in measure}.
\end{proof}

The definitions of almost uniform convergence and of convergence in measure were given for non-negative measures. We extend these definitions to an arbitrary measure $\mu$ simply by applying them to $|\mu|$.

\begin{definition}
Let $\mu$ be an arbitrary measure on a measurable space $(X, S)$, and let $E\subseteq X$. Then a sequence, $f_n$, of functions will be said to converge on $E$ to a function $f$ \defline{almost uniformly} (resp. \defline{in measure}) with respect to $\mu$ if $f_n$ converges to $f$ on $E$ almost uniformly (resp. in measure) with respect to $|\mu|$. We define what is meant by a sequence of functions which is \defline{almost uniformly Cauchy} (resp. \defline{Cauchy in measure}) with respect to $\mu$, in analogous fashion. 
\end{definition}

\section{Exercises}

\begin{enumerate}[label=\arabic*),ref=\arabic*]
\item\label{exer:non sep range}
Let $X$ be an uncountable set, and let $S$ be the $\sigma$-field of all subsets of $X$. Let $\ell^\infty(X)$ be the Banach space of all bounded real-valued functions on $X$ (with the supremum norm). Find a function from $X$ to $\ell^\infty(X)$ which has the property that $f^{-1}(U)\in S$ for every open subset $U$ of $\ell^\infty(X)$, but such that $f$ is not $S$-measurable (Thus the condition that the range be separable cannot be omitted from the characterization of $S$-measurable functions given in Theorem \ref{thm:characterization of meas func}.)

\item\label{exer:cts on R meas}
Prove that if $f$ is a continuous function on the real line into a Banach space $B$, then $f$ is Borel measurable (that is, measurable with respect to the $\sigma$-field of Borel subsets of the real line). To what more general class of topological spaces than the real line can you extend this result?

\item Show that if $(X,S)$ is a measurable space, and if $S$ has cardinality $2^\alpha$ where $\alpha$ is the countable cardinal (for example, if $S$ is the $\sigma$-field of Borel subsets of the line, see Exercise \ref{exer:construct borel for reals} of Chapter \ref{ch:measures}), and if $f$ is a function on $X$ with values in a Banach space $B$ such that $f^{-1}(U)\in S$ for every open set $U$ in $B$, then $f$ in $S$-measurable. Hint: Show that the range of $f$ must be separable. To do this, show that in any non-separable metric space there is an uncountable collection of disjoint open balls. You may then invoke the continuum hypothesis. (However, those who are quite familiar with the theory of analytic sets will be able to avoid the use of the continuum hypothesis, as was pointed out to us by R. Solovay.) Compare this result with Exercise \ref{exer:non sep range}.

\item Let $\mu$ be Lebesgue measure on the real line. Find sequences of real-valued measurable functions on the real line which:
\begin{enumerate}[label=\alph*),ref=\theenumi\alph*)]
    \item Converge a.e. but not a.u. Thus Egoroff's theorem does not hold if the set under consideration has infinite measure.
    \item Converges a.e. but not in measure.
    \item\label{exer:item:in measure not ae}
    Converges in measure but not a.e.
\end{enumerate}

\item Let $(X,S,\mu)$ be a measure space. Prove that any $S$-measurable function from $X$ to a Banach space $B$ locally almost has compact range, that is, given any $E\in S$ with $|\mu|(E)<\infty$ (``locally'') and given $\ep>0$, there is a measurable $F\subseteq E$ with $|\mu|(E\sd F)<\ep$ (``almost''), such that the range of $f$ restricted to $F$ is a precompact subset of $B$. Hint: Use the definition of compactness in terms of total boundedness. (This result is related to the Radon-Nikodym theorem which we will prove in Chapter 7.) %FIXME linking can't be resolved now

\item\label{exer:essential range}
When working with $\mu$-measurable functions and when identifying functions which agree a.e., one would like to be able to talk about the ranges of such functions, but in such a way that the range of two functions which agree a.e. are the same. The appropriate definition is that of the \defline{essential range} of a $\mu$-measurable function $f$. If $E$ is locally measurable, then the essential range of $f$ on $E$, $\er{f}{E}$, is defined to be the set of $b \in B$ such that for all $\ep>0$, the set $\brc{x\in E:\norm{f(x)-b}<\ep}$ contains a measurable set of strictly positive $|\mu|$-measure. %I just changed it lol
\begin{enumerate}
    \item Verify the following simply properties of $\er{f}{E}$
    \begin{enumerate}[label=\arabic*)]
        \item $\er{f}{E}$ is closed,
        \item $\er{f}{E}\subseteq\text{closure of }f(E)$,
        \item If $f=g$ a.e. on $E$, then $\er{f}{E}=\er{g}{E}$,
        \item If $F\subseteq E$, then $\er{f}{F}\subseteq\er{f}{E}$,
        \item If $|\mu|(E)=0$, then $\er{f}{E}=\varnothing$.
    \end{enumerate}
    
    \item Show that if $E$ is measurable and $|\mu|(E)\neq 0$, then $\er{f}{E}\cap f(E)\neq\varnothing$ and, in fact, that $\brc{x \in E: f(x)\notin\er{f}{E}}$ is a null set in $E$. Thus $f$ can be changed on a null set so that $f(E) \subseteq\er{f}{E}$ (unless $|\mu|(E)=0)$. But show by example that if two sets, $E$ and $F$, are given, then it may not be possible to change $f$ so that $f(E)\subseteq\er{f}{E}$ and $f(F)\subseteq\er{f}{F}$ simultaneously.
    
    \item Show that if $E=\bigcup_{i=1}^\infty E_i$, then $\er{f}{E}=\text{closure}\br{\bigcup_{i=1}^\infty\er{f}{E_i}}$.
\end{enumerate}

\item\label{exer:essentially bounded}
A measurable function on $X$ is said to be essentially bounded if $\er{f}{X}$ is a bounded set. Traditionally the vector space (why?) of essentially bounded functions with values in the Banach space $B$ is denoted by $\cL^\infty(X, B)$. A seminorm, $\norm{\imarg}_\infty$, is defined on $\cL^\infty(X, B)$ by $$\norm{f}_\infty=\sup\brc{\norm{b}: b\in\er{f}{X}}.$$
\begin{enumerate}
    \item Show that the set of functions, $f$, such that $\norm{f}_\infty=0$ is a subspace, $N$, of $\cL^\infty$. Show that if $\norm{f}_\infty=0$ then $f=0$. a.e.
    
    \item The quotient space $\cL^\infty/N$ is traditionally denoted by $L^\infty$. Show that the elements of $L^\infty$ are the equivalence classes of functions in $\cL^\infty$ which agree a.e. Show that $\norm{\imarg}_\infty$ defines a norm on $L^\infty$ for which $L^\infty$ is a Banach space.

    \item Show that the simple measurable functions (more precisely, their equivalence classes) are dense in $L^\infty(X,\bR)$, but are not dense in $L^\infty(X, B)$ where $B=\ell^1$, for example.

    \item Show that if either $B=\bR$ or $B=\bC$ and if multiplication is defined in $L^\infty(X, B)$ to be pointwise multiplication, then $L^\infty(X, B)$ is a Banach algebra, that is, an algebra for which $\norm{fg}_\infty\leq\norm{f}_\infty\norm{g}_\infty$.
\end{enumerate}

\item Let $(X, S, \mu)$ be a measure space with $\mu$ finite and positive, and let $B$ be a fixed Banach space. Let $F$ be the vector space of all functions from $X$ to $B$, and define the distance between any two elements, $f$ and $g$, of $F$ to be $$d(f,g)=\inf_{\ep>0}\frac{\ep+\mu^*(\brc{x:\norm{g(x)-f(x)}\geq\ep})}{1+\ep+\mu^*(\brc{x:\norm{g(x)-f(x)}\geq\ep})}.$$
Show that $d$ is a pseudometric on $F$ which defines convergence in measure, that is, a sequence, $f_n$, of elements of $F$ converges in measure to $f\in F$ iff $d(f_n, f)$ converges to 0. (It is a curious fact that the smallest convex set in $F$ containing any $d$-neighborhood of 0 is all of $F$ itself if, for example, $\mu$ is Lebesgue measure.)

\item\label{exer:precpct range seq of simple func}
Show that if $f$ is a $B$-valued measurable function and if $E$ is a locally measurable set such that $f(E)$ is a precompact subset of $B$, then there exists a sequence of simple measurable functions which converges \defline{uniformly} to $f$ on $E$.
\end{enumerate}